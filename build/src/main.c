/* main.c generated by valac 0.20.1, the Vala compiler
 * generated from main.vala, do not modify */

/*
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <gtk/gtk.h>
#include <granite.h>

#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _g_option_context_free0(var) ((var == NULL) ? NULL : (var = (g_option_context_free (var), NULL)))

#define FI_TYPE_FOTO_IMPORT (fi_foto_import_get_type ())
#define FI_FOTO_IMPORT(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), FI_TYPE_FOTO_IMPORT, FiFotoImport))
#define FI_FOTO_IMPORT_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), FI_TYPE_FOTO_IMPORT, FiFotoImportClass))
#define FI_IS_FOTO_IMPORT(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), FI_TYPE_FOTO_IMPORT))
#define FI_IS_FOTO_IMPORT_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), FI_TYPE_FOTO_IMPORT))
#define FI_FOTO_IMPORT_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), FI_TYPE_FOTO_IMPORT, FiFotoImportClass))

typedef struct _FiFotoImport FiFotoImport;
typedef struct _FiFotoImportClass FiFotoImportClass;
typedef struct _FiFotoImportPrivate FiFotoImportPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

struct _FiFotoImport {
	GraniteApplication parent_instance;
	FiFotoImportPrivate * priv;
	gchar* srcdir;
};

struct _FiFotoImportClass {
	GraniteApplicationClass parent_class;
};


extern gchar* _app_cmd_name;
gchar* _app_cmd_name = NULL;
extern gchar* srcdir;
gchar* srcdir = NULL;

gint _vala_main (gchar** args, int args_length1);
FiFotoImport* fi_foto_import_new (void);
FiFotoImport* fi_foto_import_construct (GType object_type);
GType fi_foto_import_get_type (void) G_GNUC_CONST;

const GOptionEntry entries[3] = {{"debug", 'd', 0, G_OPTION_ARG_NONE, NULL, "Enable debugging", NULL}, {"srcdir", 's', 0, G_OPTION_ARG_STRING, &srcdir, "Source directory", NULL}, {NULL}};

gint _vala_main (gchar** args, int args_length1) {
	gint result = 0;
	gint ret = 0;
	gchar* _tmp0_;
	GOptionContext* _tmp1_;
	GOptionContext* context;
	GOptionContext* _tmp2_;
	FiFotoImport* _tmp6_;
	FiFotoImport* app;
	const gchar* _tmp7_;
	FiFotoImport* _tmp19_;
	gchar** _tmp20_;
	gint _tmp20__length1;
	gint _tmp21_ = 0;
	GError * _inner_error_ = NULL;
	_tmp0_ = g_strdup ("FotoImport");
	_g_free0 (_app_cmd_name);
	_app_cmd_name = _tmp0_;
	_tmp1_ = g_option_context_new ("- [src directory]");
	context = _tmp1_;
	_tmp2_ = context;
	g_option_context_add_main_entries (_tmp2_, entries, GETTEXT_PACKAGE);
	{
		GOptionContext* _tmp3_;
		_tmp3_ = context;
		g_option_context_parse (_tmp3_, &args_length1, &args, &_inner_error_);
		if (_inner_error_ != NULL) {
			goto __catch0_g_error;
		}
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GError* _tmp4_;
		const gchar* _tmp5_;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp4_ = e;
		_tmp5_ = _tmp4_->message;
		g_warning ("main.vala:40: %s", _tmp5_);
		_g_error_free0 (e);
	}
	__finally0:
	if (_inner_error_ != NULL) {
		_g_option_context_free0 (context);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return 0;
	}
	gtk_init (&args_length1, &args);
	_tmp6_ = fi_foto_import_new ();
	app = _tmp6_;
	_tmp7_ = srcdir;
	if (_tmp7_ != NULL) {
		FiFotoImport* _tmp8_;
		const gchar* _tmp9_;
		gchar* _tmp10_;
		_tmp8_ = app;
		_tmp9_ = srcdir;
		_tmp10_ = g_strdup (_tmp9_);
		_g_free0 (_tmp8_->srcdir);
		_tmp8_->srcdir = _tmp10_;
	} else {
		gchar** _tmp11_;
		gint _tmp11__length1;
		const gchar* _tmp12_;
		_tmp11_ = args;
		_tmp11__length1 = args_length1;
		_tmp12_ = _tmp11_[1];
		if (_tmp12_ != NULL) {
			gchar** _tmp13_;
			gint _tmp13__length1;
			const gchar* _tmp14_;
			FiFotoImport* _tmp15_;
			gchar** _tmp16_;
			gint _tmp16__length1;
			const gchar* _tmp17_;
			gchar* _tmp18_;
			_tmp13_ = args;
			_tmp13__length1 = args_length1;
			_tmp14_ = _tmp13_[1];
			g_print ("Srcdir is: %s\n", _tmp14_);
			_tmp15_ = app;
			_tmp16_ = args;
			_tmp16__length1 = args_length1;
			_tmp17_ = _tmp16_[1];
			_tmp18_ = g_strdup (_tmp17_);
			_g_free0 (_tmp15_->srcdir);
			_tmp15_->srcdir = _tmp18_;
		} else {
			result = 1;
			_g_object_unref0 (app);
			_g_option_context_free0 (context);
			return result;
		}
	}
	g_debug ("main.vala:57: Running app\n");
	_tmp19_ = app;
	_tmp20_ = args;
	_tmp20__length1 = args_length1;
	_tmp21_ = granite_application_run ((GraniteApplication*) _tmp19_, _tmp20_, _tmp20__length1);
	ret = _tmp21_;
	gtk_main ();
	result = ret;
	_g_object_unref0 (app);
	_g_option_context_free0 (context);
	return result;
}


int main (int argc, char ** argv) {
	g_type_init ();
	return _vala_main (argv, argc);
}



